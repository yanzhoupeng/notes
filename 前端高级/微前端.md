## 什么是微前端

借鉴了后端的**微服务**架构理念，将一个大型的前端应用拆分成多个模块，每个模块分别开发管理，并可以自主选择框架，独立部署

优势
- 团队自治
- 兼容老项目
- 跨技术栈

## 现有微前端方案

#### iframe

缺点
- URL不同步，刷新页面丢失路由
- 全局上下文完全隔离
- UI不同步，iframe中打开了遮罩层，并不会影响到外部
- 慢

#### single-spa

在基座上注册所有的子应用和路由，URL改变时去匹配路由并进行加载

缺点
- 无法做到JS和CSS隔离
- 配置多，无法开箱即用

#### qiankun

开箱即用

## qiankun

#### 项目结构

```shell
- micro-project // 基座
- sub-react  // react 子应用
- sub-vue    // vue 子应用
- sub-jquery // jQuery 子应用
```

- 基座
	- 负责子应用的集成，提供访问所有展示的子应用的入口
	- 尽量不要在基座中写业务逻辑
- 子应用

#### 基座

##### 1. 搭建主应用

```shell
pnpm create vite@latest mirco-app // 创建vite项目
pnpm create vue@latest mirco-app // 创建vue项目
```

##### 2. 安装 qiankun

```shell
pnpm install qiankun
```

##### 3. 配置主应用

```TS
// apps.ts
export default [
  {
    name: 'vue-app', //子应用名称
    entry: 'http://localhost:7001', //子应用入口
    container: '#sub-vue-app', //子应用挂载容器
    activeRule: '#/vue', //子应用激活的路由规则
  },
]
```

```TS
// main.ts 内
import {registerMicroApps, start} from "qiankun";
import apps from './apps'

//注册子应用
registerMicroApps(apps)

//启动qiankun
start()
```

在主应用中注册微应用

```JS
import { registerMicroApps, start } from 'qiankun';

registerMicroApps([
  {
    name: 'react app', // app name registered
    entry: '//localhost:7100',
    container: '#yourContainer',
    activeRule: '/yourActiveRule',
  },
  {
    name: 'vue app',
    entry: { scripts: ['//localhost:7100/main.js'] },
    container: '#yourContainer2',
    activeRule: '/yourActiveRule2',
  },
]);

start();
```

## monorepo
